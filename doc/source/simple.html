<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">Ext.Loader.setConfig({
  enabled: true,
  paths: {'Cs': '../src'},
  disableCaching: false
});

Ext.require(['Cs.file.data.FileManager',
             'Ext.container.Container',
             'Cs.file.ui.SimpleFileUploader'
            ]);     

Ext.onReady(function() {
  var mgr = Ext.create('Cs.file.data.FileManager'),
  root,
  form;

  root = Ext.create('Ext.container.Container', {
    renderTo: Ext.getBody(),
    layout: { type: 'vbox', align: 'stretch' },
    width: 600,
    height: 300,
    style: { background: &quot;#eee&quot; },
    items: [{
      xtype: 'form',
      name: 'uploadForm',
      height: 30,
      width: '100%',
      items: {
        xtype: 'textfield',
        fieldLabel: 'Your Name',
        name: 'name',
        allowBlank: false
      }
    }, { 
      xtype: 'simplefileuploader',
      url: 'upload.html',
      padding: 5,
      uploadWith: function(file, req) {

        if(form.getForm().isValid()) {
          if(!Ext.isObject(req.params))
            req.params = {};

          req.params = Ext.apply(req.params, { 
            username: userName.getValue()
          });

          if(file.get('type') == Cs.file.data.File.FILE) 
            req.params = Ext.apply(req.params,  {format: &quot;RAW&quot;});
          else if(file.get('type') == Cs.file.data.File.FORM) 
            req.params = Ext.apply(req.params,  {format: &quot;FORM&quot;});
          else
            return false;

          return req;
        }
        else
          return false;
      }}]});

  form = root.down(&quot;form&quot;);
  userName = form.down(&quot;textfield&quot;);

});
</pre>
</body>
</html>
